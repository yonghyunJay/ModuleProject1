<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/head"></head>
<body>

	<!-- Navigation -->
	<nav th:replace="common/nav"></nav>

	<!-- Page Content -->
	<div class="container">

		<div class="row">

			<div id="keyword" class="col-lg-3">

				<h1 class="my-4">Key words</h1>
				<div class="list-group" th:if="${session.user_info} != null">
					<a href="#" class="list-group-item active" id="item1"
						th:if="${session.user_info.keyword1} != null">[[${session.user_info.keyword1}]]</a>
					<a href="#" class="list-group-item" id="item2"
						th:if="${session.user_info.keyword2} != null">[[${session.user_info.keyword2}]]</a>
					<a href="#" class="list-group-item" id="item3"
						th:if="${session.user_info.keyword3} != null">[[${session.user_info.keyword3}]]</a>
					<a href="#" class="list-group-item" id="item4"
						th:if="${session.user_info.keyword4} != null">[[${session.user_info.keyword4}]]</a>
					<a href="#" class="list-group-item" id="item5"
						th:if="${session.user_info.keyword5} != null">[[${session.user_info.keyword5}]]</a>
				</div>

			</div>
			<!-- /.col-lg-3 -->

			<div id="view" class="col-lg-9">

				<div class="row">

					<contents th:replace="contents"></contents>
					
				</div>
				<!-- /.row -->

			</div>
			<!-- /.col-lg-9 -->

		</div>
		<!-- /.row -->

	</div>
	<!-- /.container -->

	<!-- Footer -->
	<footer th:replace="common/footer"></footer>
	
	<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>

	<script>
		$('.list-group-item').click(function() {
			var listadd = [];
			
			//console.log(this.id);
			var selId = '#'+ this.id;
			
			$("#item1").removeClass("active");
			$("#item2").removeClass("active");
			$("#item3").removeClass("active");
			$("#item4").removeClass("active");
			$("#item5").removeClass("active");
			$(selId).addClass("active");
			
			$.ajax({
				url : '/getYoutube',
				type : 'get',
				data : {
					'youtubeTopic' : $(selId).text()
				},
				async : false,
				success : function(res) {
					var items = res.items;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = items[i].snippet.title;
						//console.log(title);
						var description = items[i].snippet.description;
						//console.log(description);
						var thumbnail = items[i].snippet.thumbnails.medium.url;
						//console.log(thumbnails);						
						var datetime = items[i].snippet.publishedAt;
						//console.log(datetime);
						var videoId = items[i].id.videoId;
						var url = "https://www.youtube.com/watch?v="
								+ videoId;
						//console.log(url);
						
						obj.title = title;
						obj.description = description;
						obj.thumbnail = thumbnail;
						obj.url = url;
						obj.ref = "youtube";
						listadd.push(obj);
					}
				}
			});
			
			console.log("------------------------------------");
			
			$.ajax({
				url : '/getKakaoVideo',
				type : 'get',
				data : {
					'videoTopic' : $(selId).text()
				},
				async : false,
				success : function(res) {
					var documents = res.documents;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = documents[i].title;
						//console.log(title);
						var thumbnail = documents[i].thumbnail;
						//console.log(thumbnail);
						var url = documents[i].url;
						//console.log(url);
						var datetime = documents[i].datetime;
						//console.log(datetime);
						
						obj.title = title;
						obj.description = null; // content = '';
						obj.thumbnail = thumbnail;
						obj.url = url;
						obj.ref = "kakao";
						listadd.push(obj);
					}
				}
			});
			
			console.log("------------------------------------");
			
			$.ajax({
				url : '/getKakaoBlog',
				type : 'get',
				data : {
					'blogTopic' : $(selId).text()
				},
				async : false,
				success : function(res) {
					var documents = res.documents;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = documents[i].title;
						//console.log(title);
						var description = documents[i].contents;
						//console.log(contents);
						var thumbnail = documents[i].thumbnail;
						//console.log(thumbnail);
						var url = documents[i].url;
						//console.log(url);
						var datetime = documents[i].datetime;
						//console.log(datetime);
						var blogname = documents[i].blogname;
						//console.log(blogname);
						
						obj.title = title;
						obj.description = description; // content = '';
						obj.thumbnail = thumbnail;
						obj.url = url;
						obj.ref = "kakao";
						listadd.push(obj);
					}
				}
			});
			
			console.log("------------------------------------");
			
			$.ajax({
				url : '/getNaverNews',
				type : 'get',
				data : {
					'naverNewsTopic' : $(selId).text()
				},
				async : false,
				success : function(res) {
					console.log($(selId).text());
					console.log(res);
					var items = res.items;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = items[i].title;
						//console.log(title);
						var url = items[i].link;
						//console.log(link);
						var description = items[i].description;
						//console.log(description);
						
						obj.title = title;
						obj.description = description; // content = '';
						obj.thumbnail = null;
						obj.url = url;
						obj.ref = "naver";
						listadd.push(obj);
					}
				}
			});
			
			console.log("------------------------------------");
			
			$.ajax({
				url : '/getNaverBlog',
				type : 'get',
				data : {
					'naverBlogTopic' : $(selId).text()
				},
				async : false,
				success : function(res) {
					console.log($(selId).text());
					console.log(res);
					var items = res.items;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = items[i].title;
						//console.log(title);
						var url = items[i].link;
						//console.log(link);
						var description = items[i].description;
						//console.log(description);
						
						obj.title = title;
						obj.description = description; // content = '';
						obj.thumbnail = null;
						obj.url = url;
						obj.ref = "naver";
						listadd.push(obj);
					}
				}
			});
			
			console.log("------------------------------------");
			
			$.ajax({
				url : '/getNaverCafe',
				type : 'get',
				data : {
					'naverCafe' : $(selId).text()
				},
				async : false,
				success : function(res) {
					console.log($(selId).text());
					console.log(res);
					var items = res.items;
					for ( var i = 0; i<5; i++ ) {
						var obj = {};
						
						var title = items[i].title;
						//console.log(title);
						var url = items[i].link;
						//console.log(link);
						var description = items[i].description;
						//console.log(description);
						
						obj.title = title;
						obj.description = description; // content = '';
						obj.thumbnail = null;
						obj.url = url;
						obj.ref = "naver";
						listadd.push(obj);
					}
				}
			});
			
			console.log('=======================================');

			var html = '';
			for(var i in listadd) {
//	 			console.log(listadd[i].title);
	 			html += '<div class="col-lg-4 col-md-6 mb-4">';
	 			html += '<div class="card h-100">';
	 			html += '<a href="' + listadd[i].url + '" target="_blank">';
	 			
	 			if(listadd[i].thumbnail != null) {
	 				html += '<img class="card-img-top" src="' + listadd[i].thumbnail + '" alt="">';	
	 			}
	 			
	 			html += '</a><div class="card-body">';
	 			html += '<h5 class="card-title">'+ listadd[i].title + '</h5>';
	 				 			
	 			if(listadd[i].description != null) {
	 				html += '<p class="card-text">' + listadd[i].description + '</p></div>';
	 			}else{
	 				html += '<p class="card-text"></p></div>';
	 			}
	 					
	 			
	 			html += '<div class="card-footer">'
	 			html += '<small class="text-muted">'
	 			html += '<a href="' + listadd[i].url + '" target="_blank"> + Read more</a></small></div></div></div>';
			}
			
			$('#view > .row').html(html);
		});
	</script>
</html>